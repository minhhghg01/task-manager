<%- include('../../partials/header') %>

    <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
        <h2>Lịch sử tác động hệ thống</h2>
    </div>

    <div class="table-responsive">
        <table class="table table-striped table-hover datatable-init">
            <thead class="table-dark">
                <tr>
                    <th>STT</th>
                    <th>Thời gian</th>
                    <th>Người thực hiện</th>
                    <th>Hành động</th>
                    <th>Đối tượng</th>
                    <th>Chi tiết</th>
                </tr>
            </thead>
            <tbody>
                <% logs.forEach((log, index)=> { %>
                    <tr>
                        <td>
                            <%= index + 1 %>
                        </td>
                        <td>
                            <%= new Date(log.createdAt).toLocaleString('vi-VN') %>
                        </td>
                        <td>
                            <% if (log.User) { %>
                                <strong>
                                    <%= log.User.fullname %>
                                </strong><br>
                                <small class="text-muted">
                                    <%= log.User.username %>
                                </small>
                                <% } else { %>
                                    <span class="text-danger">Đã xóa</span>
                                    <% } %>
                        </td>
                        <td>
                            <% let badgeClass='secondary' ; if (log.action==='CREATE' ) badgeClass='success' ; if
                                (log.action==='UPDATE' ) badgeClass='warning text-dark' ; if (log.action==='DELETE' )
                                badgeClass='danger' ; %>
                                <span class="badge bg-<%= badgeClass %>">
                                    <%= log.action %>
                                </span>
                        </td>
                        <td>
                            <%= log.entity_type %> (ID: <%= log.entity_id %>)
                        </td>
                        <td>
                            <%= log.details %>
                        </td>
                    </tr>
                    <% }) %>
            </tbody>
        </table>
    </div>

    <%- include('../../partials/footer') %>